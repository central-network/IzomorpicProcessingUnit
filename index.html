<script>
    WebAssembly.instantiateStreaming(fetch("cpu.wasm"), self).then(wasm => {
        const cpu = wasm.instance.exports;
        console.error({ cpu });

        setTimeout(() => cpu.this.destroy(), 3000)

        const source = new Float32Array(12).map(Math.random);
        const values = cpu.new(Float32Array, 12).fill(100);
        const target = new Float32Array(12);

        console.table([
            { view: source, offset: source.byteOffset, length: source.length, buffer: source.buffer },
            { view: values, offset: values.byteOffset, length: values.length, buffer: values.buffer },
            { view: target, offset: target.byteOffset, length: target.length, buffer: target.buffer },
        ]);

        let call = cpu.mul(source, values, target);
        call.then(() => console.warn(target))
        console.warn(call);
    });
</script>